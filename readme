See https://github.com/morenice/ahocorasick
for aho-corasick algorithm


Config sample

/!begin!/ {
    # This pattern will get invoked at the start of the program
}

/!end!/ {
    # This pattern will get invoked at the end of the program
}

/!user-defined!/ {
    
}

/pattern/ {
    # If present, print n lines before the match
    after n

    before n

    # If present, print n lines after the match
    after --fmt "     " 4

    # print a maximum number of times. if --exit, exit
    # the program
    max-count --exit n

    # Print format, if it does not exist, print the line
    # ${lineno}  Line number
    # ${offset}  File offset
    # ${match:n}  Print match pattern + addional chars
    # ${match/c}  Print match pattern until the given delimiter 'c' is seen
    # ${line}     Print the whole line
    # ${line:m,}  Print the line, from m to eol
    # ${line:,n}  Print the line, from bol to n
    # ${line:m,n} Print the line columns m through n
    # ${time_t}   If the match line contains a timestamp, 
                  print it in unix time format (time_t)
    # ${filename} print the current filename
    print "fmt"
    
    regex args...

    # Search for a sub pattern/
    # This will only search the matched line
    /pattern/ {
        commands
            .
            .
            .
    }


    # Send output to this file
    file "junk"

    # If present, exit when pattern is found
    exit
}


##################################################################
OrderId {
    /ExecutionReport/ {
        print-er
        print
    }
    /OrderCancelReject/ {
        print-ocr
        print
    }
}

bof {
     print "Start search"
}

eof {
    print "Number of trades: $trade\n"
    print "Number of NOS: $nos\n"
}

/S T A R T/ {
    print
}

/S H U T D O W N/ {
    print
}

/Orderserver is ready/ {
    print
}

/9fbe0-345f-7822/ {
    /account_id=/ {
        print "${match/ }"
    }
    /user_id=/ {
        print "${match/ }"
    }
    /exec_type=/ {
        print "${match/ }"
    }
    print "${lineno} ${line:,120}"
}

/LEADER |/ {
    print "The leader is: $line\n"
}

/xxxx-xxx-xxxxx-xxx/ {
    /EXEC_TYPE_TRADE/ {
        $trade = +1
    }
    /EXEC_TYPE_NOS/ {
        $nos += 1
    }
}

/ExecutionReport/ {
    print-timestamp
}
